<%#
 Copyright 2018-2019 Lienol <lawlienol@gmail.com>
 Licensed to the public under the Apache License 2.0.
-%>

<%
function trim(s)
  return (s:gsub("^%s*(.-)%s*$", "%1"))
end
local dsp = require "luci.dispatcher"
-%>

<script type="text/javascript">
	//<![CDATA[
	function add_server(type) {
		var link=prompt("<%:Please Enter The Link%>");
		if(link) {
			XHR.get('<%=dsp.build_url("admin/vpn/passwall/link_add_server")%>', {
				'type': type,
				'link': link
			},
			function(x, data) {
				if(x && x.status == 200) {
					window.location.href = '<%=dsp.build_url("admin/vpn/passwall/server_list")%>';
				}
				else {
					alert("<%:Error%>");
				}
			});
		}
	}
	//]]>
</script>

<div class="cbi-value">
	<label class="cbi-value-title"><%:Add Server%></label>
	<div class="cbi-value-field">
		<input class="cbi-button cbi-button-add" type="button" onclick="add_server('SSR')" value="SSR">
		<input class="cbi-button cbi-button-add" type="button" onclick="add_server('V2ray')" value="V2ray">
	</div>
</div>